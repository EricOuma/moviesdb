{% extends 'movies/base.html' %}

{% block title %}Search Results - MovieDB{% endblock %}

{% block content %}
<!-- Header -->
<div class="mb-8">
    <h1 class="text-4xl font-bold text-gray-900 mb-4">Search Results</h1>
    {% if query %}
    <p class="text-gray-600">Results for "<span class="font-semibold">{{ query }}</span>"</p>
    {% else %}
    <p class="text-gray-600">Enter a search term to find movies, TV shows, and actors</p>
    {% endif %}
</div>

{% if query %}
<!-- Search Form -->
<div class="bg-white rounded-lg shadow-sm p-6 mb-8">
    <form method="GET" action="{% url 'movies:search' %}" class="space-y-6">
        <!-- Main Search -->
        <div class="flex space-x-4">
            <div class="flex-1">
                <input type="text" name="q" value="{{ query }}" 
                       placeholder="Search movies, TV shows, actors..."
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-movie-red focus:border-transparent">
            </div>
            <button type="submit" class="px-6 py-3 bg-movie-red text-white rounded-lg hover:bg-red-700 transition-colors">
                <i class="fas fa-search mr-2"></i>Search
            </button>
        </div>
        
        <!-- Filters -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
            <!-- Content Type Filter -->
            <div>
                <label for="content_type" class="block text-sm font-medium text-gray-700 mb-2">Content Type</label>
                <select name="content_type" id="content_type" 
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-movie-red focus:border-transparent">
                    <option value="all" {% if content_type == 'all' %}selected{% endif %}>All</option>
                    <option value="movies" {% if content_type == 'movies' %}selected{% endif %}>Movies Only</option>
                    <option value="tv_shows" {% if content_type == 'tv_shows' %}selected{% endif %}>TV Shows Only</option>
                    <option value="actors" {% if content_type == 'actors' %}selected{% endif %}>Actors Only</option>
                </select>
            </div>
            
            <!-- Min Rating Filter -->
            <div>
                <label for="min_rating" class="block text-sm font-medium text-gray-700 mb-2">Min Rating</label>
                <select name="min_rating" id="min_rating" 
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-movie-red focus:border-transparent">
                    <option value="">Any Rating</option>
                    <option value="1" {% if min_rating == '1' %}selected{% endif %}>1+ Stars</option>
                    <option value="2" {% if min_rating == '2' %}selected{% endif %}>2+ Stars</option>
                    <option value="3" {% if min_rating == '3' %}selected{% endif %}>3+ Stars</option>
                    <option value="4" {% if min_rating == '4' %}selected{% endif %}>4+ Stars</option>
                    <option value="5" {% if min_rating == '5' %}selected{% endif %}>5 Stars</option>
                </select>
            </div>
            
            <!-- Max Rating Filter -->
            <div>
                <label for="max_rating" class="block text-sm font-medium text-gray-700 mb-2">Max Rating</label>
                <select name="max_rating" id="max_rating" 
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-movie-red focus:border-transparent">
                    <option value="">Any Rating</option>
                    <option value="1" {% if max_rating == '1' %}selected{% endif %}>1 Star</option>
                    <option value="2" {% if max_rating == '2' %}selected{% endif %}>2 Stars</option>
                    <option value="3" {% if max_rating == '3' %}selected{% endif %}>3 Stars</option>
                    <option value="4" {% if max_rating == '4' %}selected{% endif %}>4 Stars</option>
                    <option value="5" {% if max_rating == '5' %}selected{% endif %}>5 Stars</option>
                </select>
            </div>
            
            <!-- Year From Filter -->
            <div>
                <label for="year_from" class="block text-sm font-medium text-gray-700 mb-2">From Year</label>
                <select name="year_from" id="year_from" 
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-movie-red focus:border-transparent">
                    <option value="">Any Year</option>
                    <option value="2024" {% if year_from == '2024' %}selected{% endif %}>2024</option>
                    <option value="2023" {% if year_from == '2023' %}selected{% endif %}>2023</option>
                    <option value="2022" {% if year_from == '2022' %}selected{% endif %}>2022</option>
                    <option value="2021" {% if year_from == '2021' %}selected{% endif %}>2021</option>
                    <option value="2020" {% if year_from == '2020' %}selected{% endif %}>2020</option>
                    <option value="2019" {% if year_from == '2019' %}selected{% endif %}>2019</option>
                    <option value="2018" {% if year_from == '2018' %}selected{% endif %}>2018</option>
                    <option value="2017" {% if year_from == '2017' %}selected{% endif %}>2017</option>
                    <option value="2016" {% if year_from == '2016' %}selected{% endif %}>2016</option>
                    <option value="2015" {% if year_from == '2015' %}selected{% endif %}>2015</option>
                    <option value="2014" {% if year_from == '2014' %}selected{% endif %}>2014</option>
                    <option value="2013" {% if year_from == '2013' %}selected{% endif %}>2013</option>
                    <option value="2012" {% if year_from == '2012' %}selected{% endif %}>2012</option>
                    <option value="2011" {% if year_from == '2011' %}selected{% endif %}>2011</option>
                    <option value="2010" {% if year_from == '2010' %}selected{% endif %}>2010</option>
                    <option value="2009" {% if year_from == '2009' %}selected{% endif %}>2009</option>
                    <option value="2008" {% if year_from == '2008' %}selected{% endif %}>2008</option>
                    <option value="2007" {% if year_from == '2007' %}selected{% endif %}>2007</option>
                    <option value="2006" {% if year_from == '2006' %}selected{% endif %}>2006</option>
                    <option value="2005" {% if year_from == '2005' %}selected{% endif %}>2005</option>
                    <option value="2004" {% if year_from == '2004' %}selected{% endif %}>2004</option>
                    <option value="2003" {% if year_from == '2003' %}selected{% endif %}>2003</option>
                    <option value="2002" {% if year_from == '2002' %}selected{% endif %}>2002</option>
                    <option value="2001" {% if year_from == '2001' %}selected{% endif %}>2001</option>
                    <option value="2000" {% if year_from == '2000' %}selected{% endif %}>2000</option>
                    <option value="1999" {% if year_from == '1999' %}selected{% endif %}>1999</option>
                    <option value="1998" {% if year_from == '1998' %}selected{% endif %}>1998</option>
                    <option value="1997" {% if year_from == '1997' %}selected{% endif %}>1997</option>
                    <option value="1996" {% if year_from == '1996' %}selected{% endif %}>1996</option>
                    <option value="1995" {% if year_from == '1995' %}selected{% endif %}>1995</option>
                    <option value="1994" {% if year_from == '1994' %}selected{% endif %}>1994</option>
                    <option value="1993" {% if year_from == '1993' %}selected{% endif %}>1993</option>
                    <option value="1992" {% if year_from == '1992' %}selected{% endif %}>1992</option>
                    <option value="1991" {% if year_from == '1991' %}selected{% endif %}>1991</option>
                    <option value="1990" {% if year_from == '1990' %}selected{% endif %}>1990</option>
                </select>
            </div>
            
            <!-- Year To Filter -->
            <div>
                <label for="year_to" class="block text-sm font-medium text-gray-700 mb-2">To Year</label>
                <select name="year_to" id="year_to" 
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-movie-red focus:border-transparent">
                    <option value="">Any Year</option>
                    <option value="2024" {% if year_to == '2024' %}selected{% endif %}>2024</option>
                    <option value="2023" {% if year_to == '2023' %}selected{% endif %}>2023</option>
                    <option value="2022" {% if year_to == '2022' %}selected{% endif %}>2022</option>
                    <option value="2021" {% if year_to == '2021' %}selected{% endif %}>2021</option>
                    <option value="2020" {% if year_to == '2020' %}selected{% endif %}>2020</option>
                    <option value="2019" {% if year_to == '2019' %}selected{% endif %}>2019</option>
                    <option value="2018" {% if year_to == '2018' %}selected{% endif %}>2018</option>
                    <option value="2017" {% if year_to == '2017' %}selected{% endif %}>2017</option>
                    <option value="2016" {% if year_to == '2016' %}selected{% endif %}>2016</option>
                    <option value="2015" {% if year_to == '2015' %}selected{% endif %}>2015</option>
                    <option value="2014" {% if year_to == '2014' %}selected{% endif %}>2014</option>
                    <option value="2013" {% if year_to == '2013' %}selected{% endif %}>2013</option>
                    <option value="2012" {% if year_to == '2012' %}selected{% endif %}>2012</option>
                    <option value="2011" {% if year_to == '2011' %}selected{% endif %}>2011</option>
                    <option value="2010" {% if year_to == '2010' %}selected{% endif %}>2010</option>
                    <option value="2009" {% if year_to == '2009' %}selected{% endif %}>2009</option>
                    <option value="2008" {% if year_to == '2008' %}selected{% endif %}>2008</option>
                    <option value="2007" {% if year_to == '2007' %}selected{% endif %}>2007</option>
                    <option value="2006" {% if year_to == '2006' %}selected{% endif %}>2006</option>
                    <option value="2005" {% if year_to == '2005' %}selected{% endif %}>2005</option>
                    <option value="2004" {% if year_to == '2004' %}selected{% endif %}>2004</option>
                    <option value="2003" {% if year_to == '2003' %}selected{% endif %}>2003</option>
                    <option value="2002" {% if year_to == '2002' %}selected{% endif %}>2002</option>
                    <option value="2001" {% if year_to == '2001' %}selected{% endif %}>2001</option>
                    <option value="2000" {% if year_to == '2000' %}selected{% endif %}>2000</option>
                    <option value="1999" {% if year_to == '1999' %}selected{% endif %}>1999</option>
                    <option value="1998" {% if year_to == '1998' %}selected{% endif %}>1998</option>
                    <option value="1997" {% if year_to == '1997' %}selected{% endif %}>1997</option>
                    <option value="1996" {% if year_to == '1996' %}selected{% endif %}>1996</option>
                    <option value="1995" {% if year_to == '1995' %}selected{% endif %}>1995</option>
                    <option value="1994" {% if year_to == '1994' %}selected{% endif %}>1994</option>
                    <option value="1993" {% if year_to == '1993' %}selected{% endif %}>1993</option>
                    <option value="1992" {% if year_to == '1992' %}selected{% endif %}>1992</option>
                    <option value="1991" {% if year_to == '1991' %}selected{% endif %}>1991</option>
                    <option value="1990" {% if year_to == '1990' %}selected{% endif %}>1990</option>
                </select>
            </div>
        </div>
        
        <!-- Clear Filters Button -->
        <div class="flex justify-between items-center">
            <a href="{% url 'movies:search' %}" class="text-gray-600 hover:text-movie-red transition-colors">
                <i class="fas fa-times mr-1"></i>Clear all filters
            </a>
            <div class="text-sm text-gray-500">
                {% if results.movies or results.tv_shows or results.actors %}
                {% if content_type == 'movies' and results.movies %}
                {{ results.movies|length }} movies found
                {% elif content_type == 'tv_shows' and results.tv_shows %}
                {{ results.tv_shows|length }} TV shows found
                {% elif content_type == 'actors' and results.actors %}
                {{ results.actors|length }} actors found
                {% else %}
                {% if results.movies %}{{ results.movies|length }} movies{% endif %}
                {% if results.tv_shows %}{% if results.movies %}, {% endif %}{{ results.tv_shows|length }} TV shows{% endif %}
                {% if results.actors %}{% if results.movies or results.tv_shows %}, {% endif %}{{ results.actors|length }} actors{% endif %}
                found
                {% endif %}
                {% endif %}
            </div>
        </div>
    </form>
</div>

<!-- Results -->
{% if results.movies or results.tv_shows or results.actors %}
<div class="space-y-8">
    <!-- Movies Results -->
    {% if results.movies %}
    <section>
        <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
            <i class="fas fa-film text-movie-red mr-3"></i>
            Movies ({{ results.movies|length }})
        </h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            {% for movie in results.movies %}
            <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
                <a href="{% url 'movies:movie_detail' movie.id %}">
                    {% if movie.poster %}
                    <img src="{{ movie.poster }}" alt="{{ movie.title }}" class="w-full h-80 object-cover">
                    {% else %}
                    <div class="w-full h-80 bg-gray-200 flex items-center justify-center">
                        <i class="fas fa-film text-gray-400 text-4xl"></i>
                    </div>
                    {% endif %}
                </a>
                <div class="p-4">
                    <h3 class="font-semibold text-lg mb-2 truncate">
                        <a href="{% url 'movies:movie_detail' movie.id %}" class="hover:text-movie-red transition-colors">
                            {{ movie.title }}
                        </a>
                    </h3>
                    <div class="flex items-center justify-between text-sm text-gray-600 mb-2">
                        <span class="bg-gray-100 px-2 py-1 rounded">{{ movie.genre|title }}</span>
                        <span>{{ movie.release_date.year }}</span>
                    </div>
                    <p class="text-gray-600 text-sm line-clamp-2">{{ movie.description|truncatewords:15 }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- TV Shows Results -->
    {% if results.tv_shows %}
    <section>
        <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
            <i class="fas fa-tv text-movie-red mr-3"></i>
            TV Shows ({{ results.tv_shows|length }})
        </h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            {% for tv_show in results.tv_shows %}
            <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
                <a href="{% url 'movies:tv_show_detail' tv_show.id %}">
                    {% if tv_show.poster %}
                    <img src="{{ tv_show.poster }}" alt="{{ tv_show.title }}" class="w-full h-80 object-cover">
                    {% else %}
                    <div class="w-full h-80 bg-gray-200 flex items-center justify-center">
                        <i class="fas fa-tv text-gray-400 text-4xl"></i>
                    </div>
                    {% endif %}
                </a>
                <div class="p-4">
                    <h3 class="font-semibold text-lg mb-2 truncate">
                        <a href="{% url 'movies:tv_show_detail' tv_show.id %}" class="hover:text-movie-red transition-colors">
                            {{ tv_show.title }}
                        </a>
                    </h3>
                    <div class="flex items-center justify-between text-sm text-gray-600 mb-2">
                        <span class="bg-gray-100 px-2 py-1 rounded">{{ tv_show.genre|title }}</span>
                        <span>{{ tv_show.start_date.year }}</span>
                    </div>
                    <p class="text-gray-600 text-sm line-clamp-2">{{ tv_show.description|truncatewords:15 }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- Actors Results -->
    {% if results.actors %}
    <section>
        <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
            <i class="fas fa-user text-movie-red mr-3"></i>
            Actors ({{ results.actors|length }})
        </h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            {% for actor in results.actors %}
            <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
                <div class="flex items-center space-x-4 mb-4">
                    <div class="w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center">
                        <i class="fas fa-user text-gray-600 text-2xl"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-lg">
                            <a href="{% url 'movies:actor_detail' actor.id %}" class="hover:text-movie-red transition-colors">
                                {{ actor.full_name }}
                            </a>
                        </h3>
                        <p class="text-gray-600 text-sm">{{ actor.total_movies }} movies</p>
                    </div>
                </div>
                <div class="text-sm text-gray-600">
                    <p>Movies: {{ actor.total_movies }}</p>
                    <p>TV Shows: {{ actor.total_tv_shows }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}
</div>

{% else %}
<!-- No Results -->
<div class="text-center py-12">
    <i class="fas fa-search text-gray-400 text-6xl mb-4"></i>
    <h3 class="text-xl font-semibold text-gray-600 mb-2">No results found</h3>
    <p class="text-gray-500 mb-6">Try searching for something else or browse our collections.</p>
    <div class="flex justify-center space-x-4">
        <a href="{% url 'movies:movie_list' %}" class="bg-movie-red text-white px-6 py-3 rounded-lg hover:bg-red-700 transition-colors">
            Browse Movies
        </a>
        <a href="{% url 'movies:tv_show_list' %}" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors">
            Browse TV Shows
        </a>
    </div>
</div>
{% endif %}

{% else %}
<!-- Empty Search State -->
<div class="text-center py-12">
    <i class="fas fa-search text-gray-400 text-6xl mb-4"></i>
    <h3 class="text-xl font-semibold text-gray-600 mb-2">Search Movies, TV Shows & Actors</h3>
    <p class="text-gray-500 mb-6">Find your favorite content by searching titles, actors, or descriptions.</p>
    
    <div class="max-w-md mx-auto">
        <form method="GET" action="{% url 'movies:search' %}" class="flex space-x-4">
            <input type="text" name="q" 
                   placeholder="Enter your search term..."
                   class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-movie-red focus:border-transparent">
            <button type="submit" class="px-6 py-3 bg-movie-red text-white rounded-lg hover:bg-red-700 transition-colors">
                Search
            </button>
        </form>
    </div>
    
    <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
        <div class="bg-white rounded-lg shadow-sm p-6">
            <i class="fas fa-film text-movie-red text-3xl mb-3"></i>
            <h4 class="font-semibold text-gray-900 mb-2">Movies</h4>
            <p class="text-gray-600 text-sm">Search through our extensive movie collection</p>
        </div>
        <div class="bg-white rounded-lg shadow-sm p-6">
            <i class="fas fa-tv text-movie-red text-3xl mb-3"></i>
            <h4 class="font-semibold text-gray-900 mb-2">TV Shows</h4>
            <p class="text-gray-600 text-sm">Discover amazing TV series and episodes</p>
        </div>
        <div class="bg-white rounded-lg shadow-sm p-6">
            <i class="fas fa-user text-movie-red text-3xl mb-3"></i>
            <h4 class="font-semibold text-gray-900 mb-2">Actors</h4>
            <p class="text-gray-600 text-sm">Find your favorite actors and their work</p>
        </div>
    </div>
</div>
{% endif %}
{% endblock %} 